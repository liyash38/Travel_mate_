<?php
session_start();

/* STEP 1: GENERATE OTP */
if(isset($_POST['send_otp'])){
    $email = $_POST['email'];
    $otp = rand(100000,999999); // 6 digit OTP

    $_SESSION['otp'] = $otp;
    $_SESSION['email'] = $email;

    // REAL PROJECT la mail() use pannuvaanga
    $info = "OTP sent successfully (Demo OTP: $otp)";
}

/* STEP 2: VERIFY OTP */
if(isset($_POST['verify_otp'])){
    if($_POST['otp'] == $_SESSION['otp']){
        $_SESSION['loggedin'] = true;
    } else {
        $error = "Invalid OTP!";
    }
}

/* LOGOUT */
if(isset($_GET['logout'])){
    session_destroy();
    header("Location:index.php");
}
?>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Travel Mate</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box;font-family:Segoe UI}
body{background:#f4f6f8;margin:0}

/* LOGIN PAGE */
.login-box{
 width:350px;
 background:white;
 padding:25px;
 margin:120px auto;
 border-radius:12px;
 box-shadow:0 10px 25px rgba(0,0,0,.2);
 text-align:center;
}
input,button{
 width:100%;
 padding:10px;
 margin:10px 0;
}
button{
 background:#002b5b;
 color:white;
 border:none;
 cursor:pointer;
}
.success{color:green}
.error{color:red}

/* WEBSITE (YOUR CODE SIMPLIFIED VIEW) */
nav{
 background:#002b5b;color:white;
 display:flex;justify-content:space-between;
 padding:15px 30px;
}
nav h2{color:#ffcc00}
nav a{color:white;margin-left:20px;text-decoration:none}
.hero{
 
    background:url("background.jpg") center/cover;
 height:80vh;display:flex;align-items:center;justify-content:center;
 color:white;text-align:center;
}
.container{max-width:1100px;margin:auto;padding:40px}
footer{background:#002b5b;color:white;text-align:center;padding:15px}
.logout{background:red;padding:6px 12px}
</style>
</head>

<body>

<?php if(!isset($_SESSION['loggedin'])){ ?>

<!-- ================= LOGIN PAGE ================= -->
<div class="login-box">
<h2>Email Login</h2>

<?php if(!isset($_SESSION['otp'])){ ?>
<form method="post">
<input type="email" name="email" placeholder="Enter Email ID" required>
<button name="send_otp">Send OTP</button>
</form>
<p class="success"><?php if(isset($info)) echo $info; ?></p>

<?php } else { ?>

<form method="get">
<input type="number" name="otp" placeholder="Enter OTP" required>
<button name="verify_otp">Verify OTP</button>
</form>
<p class="error"><?php if(isset($error)) echo $error; ?></p>

<?php } ?>
</div>

<?php } else { ?>

<!-- ================= HOME PAGE (YOUR WEBSITE) ================= -->

<nav>
<h2>Travel Mate</h2>
<div>
<a href="#packages">Packages</a>
<a href="#reviews">Reviews</a>
<a href="#booking">Booking</a>
<a href="?logout=true" class="logout">Logout</a>
</div>
</nav>

<div class="hero">
<div>
<h1 style="color:#250430">Explore the World with Us</h1>
<p style="color: rgb(41, 2, 29)">India's Trusted Holiday Partner</p>
</div>
</div>

<div class="container">
<h2>Welcome ðŸŽ‰</h2>
<p>Email ID: <?php echo $_SESSION['email']; ?></p>
<p>OTP verified login successful.</p>
</div>

<footer>
<p>Â© 2026 Travel Mate | Big Project</p>
</footer>

<?php } ?>

</body>
</html>
